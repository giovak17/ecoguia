{% extends 'usuarios/base.html' %}
{% load static %}
{% block content %}
<div class="container">
  <h1 class="mt-4 mb-4">Contenido Educativo</h1>
  <div class="row">
    {% for item in contenidos %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card" data-bs-toggle="modal" data-bs-target="#modal{{ forloop.counter }}" style="cursor: pointer;">
          <!--<div class="card"> -->
          <div class="card-body">
            <h5 class="card-title">{{ item.titulo }}</h5>
            <p class="card-text">{{ item.descripcion }}</p>
            <p class="card-text text-muted">Publicado el {{ item.fecha }}</p>
            {% if item.tipo == "imagen" %}
            <img src="{% static item.archivo %}" class="img-fluid" alt="{{ item.titulo }}">
              {# Video local desde static/ #}
            {% elif item.tipo == "video" %}
            <div class="ratio ratio-16x9">
              <video muted class="w-100">
                <source src="{% static item.archivo %}" type="video/mp4">
                Tu navegador no soporta videos.
              </video>
            </div>

            {# Video de YouTube incrustado #}
            {% elif item.tipo == "youtube" %}
              <div class="ratio ratio-16x9">
                <iframe src="{{ item.archivo }}" allowfullscreen></iframe>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
      <div class="modal fade" id="modal{{ forloop.counter }}" tabindex="-1" aria-labelledby="modalLabel{{ forloop.counter }}" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalLabel{{ forloop.counter }}">{{ item.titulo }}</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body text-center">
              {% if item.tipo == "imagen" %}
                <!--<img src="{{ item.archivo }}" class="img-fluid rounded mb-3" alt="{{ item.titulo }}">-->
                <img src="{% static item.archivo %}" class="img-fluid rounded mb-3" alt="{{ item.titulo }}">
              {% elif item.tipo == "video" %}
                <video controls class="w-100 rounded">
                  <source src="{% static item.archivo %}" type="video/mp4">
                  Tu navegador no soporta videos.
                </video>
              {% elif item.tipo == "youtube" %}
                <div class="ratio ratio-16x9 rounded">
                  <iframe src="{{ item.archivo }}" allowfullscreen></iframe>
                </div>
              {% endif %}
              <p class="mt-3">{{ item.descripcion }}</p>
              <small class="text-muted">Fecha de publicaci√≥n: {{ item.fecha }}</small>
            </div>
          </div>
        </div>
      </div>

    {% endfor %}
  </div>
</div>
{% endblock %}
